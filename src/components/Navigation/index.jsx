import React, { Component } from "react";
import { NavLink } from "react-router-dom";
import { connect } from 'react-redux';

import './styles.css';

import AppBar from '@material-ui/core/AppBar';
import Toolbar from '@material-ui/core/Toolbar';
import Container from '@material-ui/core/Container';

class Navigation extends Component {

    componentDidUpdate(prevProps) {
        console.log(prevProps);
        console.log(this.props);
        if (this.props.items !== prevProps.items) {
            this.getItemsCount();
        }
    }

    getItemsCount() {
        const { items } = this.props;
        console.log(items);
        let total = 0;

        if (items.length) {
            items.map(item => {
                total = total + item.qty
                return item;
            });
        }

        return total;
    }

    render() {
        const total = this.getItemsCount();
        return (
            <AppBar align="center">
                <Toolbar>
                    <Container>
                        <h2 className="title">
                            <span>Eat your greens</span>
                            <span className="icon">
                                <svg height="30px" width="30px" fill="#ffffff" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="m70.039062 330.839844c16.617188 34.988281 53.414063 60.160156 95.960938 60.160156 3.195312 0 6.394531-.148438 9.574219-.4375l5.425781 8.140625v98.296875c0 8.285156 6.714844 15 15 15h120c8.285156 0 15-6.714844 15-15v-98.296875l5.425781-8.140625c3.179688.289062 6.378907.4375 9.574219.4375 42.539062 0 79.339844-25.164062 95.960938-60.160156 39.050781-2.5625 70.039062-35.152344 70.039062-74.839844 0-25.566406-12.851562-48.867188-33.65625-62.570312 2.429688-8.921876 3.65625-18.101563 3.65625-27.429688 0-28.007812-11.109375-54.542969-31.28125-74.71875-20.175781-20.171875-46.710938-31.28125-74.71875-31.28125-2.746094 0-5.472656.109375-8.179688.316406-24.984374-37.449218-66.933593-60.316406-111.820312-60.316406s-86.835938 22.867188-111.820312 60.316406c-62.398438-4.769531-114.179688 45.800782-114.179688 105.683594 0 9.328125 1.226562 18.507812 3.660156 27.429688-20.808594 13.703124-33.660156 37.003906-33.660156 62.570312 0 39.6875 30.988281 72.277344 70.039062 74.839844zm230.960938 63.320312v87.839844h-90v-87.839844c0-2.960937-.875-5.855468-2.519531-8.316406-8-12-56.773438-85.164062-64.878907-97.324219 2.820313-5.859375 4.863282-12.046875 6.074219-18.433593 5.246094-.703126 10.410157-1.824219 15.46875-3.328126l48.375 72.5625c8.210938 12.316407 27.480469 6.46875 27.480469-8.320312v-60.863281c4.964844.5625 9.972656.863281 15 .863281s10.035156-.300781 15-.863281v60.863281c0 14.890625 19.308594 20.578125 27.480469 8.320312l48.375-72.5625c5.058593 1.503907 10.222656 2.625 15.46875 3.328126 1.210937 6.382812 3.25 12.574218 6.074219 18.433593-8.105469 12.164063-56.871094 85.304688-64.878907 97.324219-1.644531 2.460938-2.519531 5.355469-2.519531 8.316406zm-107.257812-138.585937c5.601562 2.9375 11.363281 5.480469 17.257812 7.589843v18.292969zm107.257812 7.589843c5.898438-2.109374 11.65625-4.65625 17.257812-7.589843l-17.257812 25.882812zm-243.269531-48.699218c7.652343-3.1875 11.273437-11.988282 8.074219-19.636719-3.851563-9.207031-5.804688-18.902344-5.804688-28.828125 0-41.664062 35.742188-77.269531 78.355469-75.941406 20.371093.894531 37.523437 8.75 50.675781 21.910156 5.859375 5.855469 15.355469 5.855469 21.214844 0 5.859375-5.859375 5.859375-15.355469 0-21.214844-9.976563-9.980468-21.613282-17.699218-34.28125-22.910156 19.769531-23.703125 49.007812-37.84375 80.035156-37.84375s60.265625 14.140625 80.035156 37.84375c-12.671875 5.210938-24.304687 12.933594-34.28125 22.910156-5.859375 5.859375-5.859375 15.355469 0 21.214844 5.855469 5.855469 15.355469 5.855469 21.210938 0 14.726562-14.726562 34.023437-21.96875 53.035156-21.96875 41.195312 0 76 34.804688 76 76 0 9.925781-1.953125 19.625-5.800781 28.828125-3.199219 7.644531.414062 16.449219 8.070312 19.636719 16.84375 7.015625 27.730469 23.316406 27.730469 41.535156 0 24.8125-20.1875 45-45 45-1.265625 0-2.546875-.054688-3.800781-.15625-6.808594-.574219-13.140625 3.535156-15.402344 9.984375-9.191406 26.214844-33.484375 45.402344-61.140625 49.390625l41.820312-62.730469c3.351563-5.03125 3.359376-11.585937.011719-16.621093-4.898437-7.371094-7.488281-15.96875-7.488281-24.867188 0-8.285156-6.714844-15-15-15-16.449219 0-32.292969-5.585938-45.824219-16.152344-5.035156-3.929687-12.007812-4.242187-17.375-.773437-17.128906 11.074219-36.769531 16.925781-56.800781 16.925781s-39.671875-5.851562-56.800781-16.925781c-5.363281-3.46875-12.339844-3.160157-17.375.773437-13.53125 10.566406-29.375 16.152344-45.824219 16.152344-8.285156 0-15 6.714844-15 15 0 8.898438-2.589844 17.496094-7.488281 24.867188-3.347657 5.035156-3.339844 11.589843.011719 16.621093l41.820312 62.730469c-27.65625-3.988281-51.949219-23.175781-61.140625-49.390625-2.261719-6.449219-8.59375-10.554687-15.402344-9.984375-1.253906.101562-2.535156.15625-3.800781.15625-24.8125 0-45-20.1875-45-45 0-18.21875 10.886719-34.523438 27.730469-41.535156zm0 0"/></svg>
                            </span>
                        </h2>
                        <ul className="navigation">
                            <li className="navigation__item">
                                <NavLink to="/" className="navigation__link" activeClassName="selected">Shop</NavLink>
                            </li>
                            <li className="navigation__item">
                                <NavLink to="/cart" className="navigation__link" activeClassName="selected">Cart {total ? `(${total})` : ''}</NavLink>
                            </li>
                        </ul>
                    </Container>
                </Toolbar>
            </AppBar>
        );
    }
}

const mapStateToProps = (state) => {
    return {
        items: state.items
    }
}

export default connect(mapStateToProps, null, null, { pure: false })(Navigation);